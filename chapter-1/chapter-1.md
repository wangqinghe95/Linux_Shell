# Linux_Shell 核心编程指南

## chapter 1

### chapter 1-1 脚本文件的书写格式

1. 以 #!/bin/bash 开头
2. 单行注释以 # 开头，多行注释以 <<[STRING] [STRING] 格式
3. 常见的转义字符

| 符号 	| 功能描述 	|
|---	|---	|
| \b 	| 退格键（Backspace） 	|
| \f 	| 换行但光标仍停留在原来的位置 	|
| \n 	| 换行且光标移至行首 	|
| \r 	| 光标移至行首，但不换行 	|
| \t 	| 插入Tab键 	|
| \\ 	| 打印\ 	|
| \033或\e 	| 设置终端属性，如字体颜色、背景颜色、定位光标等 	|

### chapter 1-2 脚本的执行方式

1. 脚本执行方法
    1. ./[script_name]
    2. source [script_name]
    3. bash [script_name]
    4. sh [script_name]
    5. . [script_name]
2. 注意文件执行权限
3. pstree 查看进程树
4. 脚本运行的方法中，方法 1/3/4 会在 bash 进程中再起一个子进程来运行脚本，而 2/5 则直接在当前进程中运行脚本
5. 常见的格式字符串以及功能描述

| %d或%i 	| 十进制整数 	|
|---	|---	|
| %o 	| 八进制整数 	|
| %x 	| 十六进制整数 	|
| %u 	| 无符号十进制整数 	|
| %f 	| 浮点数（小数点数） 	|
| %s 	| 字符串 	|

### chapter 1-3 输入输出

#### echo

1. echo [string] 输出打印信息
    + string 会以空格为分隔符分为多个条目
    + 引号内部的内容会被认为是一个条目
    + 转义字符需要加参数 -e 才能被识别
    + 可以通过转移字符控制输出的大小，颜色，格式等字体属性

#### printf

1. printf 的用法可以等同认为是 C/C++ 中的printf用法
    + 支持输出格式
    + 支持输出宽度

#### read

1. read 常用命令选项

| 选项 	| 功能 	|
|---	|---	|
| -p 	| 显示提示信息 	|
| -t 	| 设置读入数据的超时时间 	|
| -n 	| 设置读取n个字符后结束，而默认会读取标准输入的一整行内容 	|
| -r 	| 支持读取\，而默认read命令理解\为特殊符号（转义字符） 	|
| -s 	| 静默模式，不显示标准输入的内容（Silent mode） 	|

### 1-4 输入输出重定向

### 1-5 引号使用

1. 单引号引起来的内容被视为一个整体，不被引起来的内容会被空格分为分成若干个条目
2. 双引号引起来的内容可以转义，单引号的转移字符会被直接打印
    + \ 字符也可以转移，只能转移一个字符，双引号内的所有转义字符都会被翻译
3. 反引号是命令替换字符，可以在双引号中使用单引号引入命令的执行
4. 反引号和单引号容易混淆，不支持嵌套，所以有 $() 可以代替单引号的命令替换功能

### 1-6 变量

1. 变量定义时等号两边不能有空格
    + 变量名称是由字母，数字和下划线构成，且不能由数字开头
    + 读取变量使用符号 '$'
    + 变量和非变量在一起时（没有空格隔开），需要使用 ‘{}’分割
    + 取消变量定义，可以使用unset删除

2. 变量名示例

| 合法的变量名 	| 非法的变量名 	|
|---	|---	|
| filename 	| file-name（不能包含其他特殊符号，-） 	|
| tom_age 	| Tom age （不能包含其他特殊符号，空格） 	|
| color_3 	| 3_color （不能以数字开头） 	|
| Server_A 	| Server* 	|
| Server_B 	| a\b （不能包含特殊符号，\） 	|
| _custom_var 	| @custum （不能包含特殊符号，@） 	|


2. 常见的系统预设变量

| 变量名 	| 描述 	|
|---	|---	|
| UID 	| 当前账户的账户ID号 	|
| USER 	| 当前账户的账户名称 	|
| HISTSIZE 	| 当前终端的最大历史命令条目数量（最多可以记录多少条历史命令） 	|
| HOME 	| 当前账户的根目录 	|
| LANG 	| 当前账户的根目录 	|
| PATH 	| 命令搜索路径 	|
| PWD 	| 返回当前工作目录 	|
| RANDOM 	| 随机返回0至32767的整数 	|
| $0 	| 返回当前命令的名称（$0、$1、$2、等，也叫位置变量） 	|
| $n 	| 返回位置参数，如$1（第一个位置参数）、$2等，数字大于9时必须使用${n} 	|
| $# 	| 命令参数的个数 	|
| $* 	| 命令行的所有参数，“$*”所有的参数作为一个整体 	|
| $@ 	| 命令行的所有参数，“$*”所有的参数作为一个整体 	|
| $? 	| 返回上一条命令退出时的状态代码（一般来说，0代表正确，非0代表失败） 	|
| $$ 	| 返回当前进程的进程号 	|
| $! 	| 返回最后一个后台进程的进程号 	|

### 1-7 grep

1. grep
    + 查看关键字并打印匹配的行
    + grep [options] pattern [file]
        + options:
            1. -i: 忽略大小写
            2. -v: 取反匹配
            3. -w: 匹配单词
            4. -q: 静默匹配，不将结果显示在屏幕上
    + 正则表达式及其含义
        + c: 匹配字母c
        + .: 陪陪单个任意字符
        + *: 匹配前一个字符出现零次或者多次
        + .*: 匹配多个任意字符
        + []: 匹配集合中的任意单个字符，括号可以是任意数字字母的集合
        + ^: 匹配字符串开头
        + $: 匹配字符串结尾
        + \: 匹配转义后的字符串
        + \{n,m\}: 匹配前一个字符重复 n 到 m 次
        + \{n,\}: 匹配前一个字符至少 n 次
        + \{n\}: 匹配前一个字符 n 次
        + \(\): 将\(\)之间的内容存储在“保留空间”，最多存储9个
        + \n: 通过 \1到 \9调用保留空间中的内容
2. 基本正则表达式及其含义

| 字符 	| 含义 	|
|---	|---	|
| c 	| 匹配字母c 	|
| . 	| 匹配任意单个字符 	|
| * 	| 匹配前一个字符出现零次或多次 	|
| .* 	| 匹配多个任意字符 	|
| [] 	| 匹配集合中的任意单个字符，括号可以是任意数量字符的集合 	|
| [x-y] 	| 匹配连续的字符串范围 	|
| ^ 	| 匹配字符串的开头 	|
| $ 	| 匹配字符串的结尾 	|
| [^] 	| 匹配否定，对括号中的集合取反 	|
| \ 	| 匹配转义后的字符串 	|
| \{n,m\} 	| 匹配前一个字符重复n到m次 	|
| \{n,\} 	| 匹配前一个字符重复至少n次 	|
| \{n\} 	| 匹配前一个字符重复n次 	|
| \(\) 	| 将\(与\)之间的内容存储在“保留空间”，最多可存储9个 	|
| \n 	| 通过\1至\9调用保留空间中的内容 	|
|  	|  	|

3. 样例

| command 	| explain 	|
|---	|---	|
| grep "root" /tmp/passwd 	| 在/tmp/passwd 文件中查找包含root的行 	|
| grep ":..0:" /tmp/passwd 	| 在/tmp/passwd 文件中查找符合字符'0'与字符"0:"之间包含任意两个字符条件的行 	|
| grep "00*" /tmp/passwd 	| 在/tmp/passwd 文件中查找至少包含一个0的行（第一个0必须出现，第二个0可以出现0次或者多次） 	|
| grep "o[os]" /tmp/passwd 	| 在/tmp/passwd 文件中查找 oot 或者 ost 的行 	|
| grep "[0-9]" /tmp/passwd 	| 在/tmp/passwd 文件中查找包含数字的行 	|
| grep "[f-q]" /tmp/passwd 	| 在/tmp/passwd 文件中查找包含字母f~q的行，（范围内任意字符都可） 	|
| grep "bash$" /tmp/passwd 	| 在/tmp/passwd 文件中查找以bash字符串结尾的行 	|
| grep "sbin/[^n]" /tmp/passwd 	| 在/tmp/passwd 文件中查找 sbin/ 后不跟字母 n 的行 	|
| grep "0\{1,2\}" /tmp/passwd 	| 在/tmp/passwd 文件中查找数字 0 出现次数在[1,2]次之间的行 	|
| grep "\(root\).*\1" /tmp/passwd 	| 在/tmp/passwd 文件中查找有两个root的行 	|
| grep "^$" /tmp/passwd 	| 在/tmp/passwd 文件中过滤空白行 	|


2. 计算
    + 常见的运算符号：等同C/C++
    + let 进行数字运算
        + let 运行不会直接显示，需要保持到变量中
    + 小数运算需要使用 bc 命令
